# Руководство по разработке (CONTRIBUTING)

## Стек

Мы используем проверенные инструменты, чтобы не усложнять разработку:

| Компонент      | Технология        | Описание                                                           |
| :------------- | :---------------- | :----------------------------------------------------------------- |
| **Language**   | **Go 1.23+**      | Основной язык разработки                                           |
| **Database**   | **PostgreSQL**    | Хранение метаданных материалов (название, уровень, теги)           |
| **Framework**  | **Gin**           | HTTP веб-фреймворк (роутинг, middleware)                           |
| **Migrations** | **Goose**         | Управление схемой базы данных (SQL)                                |
| **Files**      | **Local FS**      | Файлы (PDF, Video) хранятся в volume контейнера (папка `/uploads`) |
| **Config**     | **Cleanenv**      | Чтение переменных окружения (.env)                                 |
| **Docs**       | **Swagger**       | Автогенерация API документации                                     |

---

## Как запустить проект

Вам понадобятся **Go**, **Docker** и **Make** (опционально)

1.  **Склонируйте репозиторий:**
```bash
    git clone [https://github.com/glycek/edu-adapt-api.git](https://github.com/glycek/edu-adapt-api.git)
    cd edu-adapt-api
```

2.  **Настройте конфиг:**
    Создайте файл `.env` в корне проекта. Вставьте туда этот текст:
```bash
    HTTP_PORT=8080
	DB_HOST=db # Настройки БД для Docker Compose
	DB_PORT=5432
	DB_USER=postgres
	DB_PASSWORD=postgres
	DB_NAME=edu_adapt
```

3.  **Запустите (БД + Приложение):**
```bash
    docker-compose up --build
```
    * API : `http://localhost:8080`
    * Swagger: `http://localhost:8080/swagger/index.html`

---

## Структура проекта

```
edu-adapt-api/
├── cmd/api/main.go          # Точка входа (запуск сервера)
├── config/                  # Чтение конфигурации
├── internal/
│   ├── domain/              # Структуры данных (Models). Самые главные файлы.
│   ├── service/             # Бизнес-логика (валидация, проверки)
│   ├── repository/          # SQL запросы к базе данных
│   └── transport/           # HTTP хендлеры (работа с Gin)
├── migrations/              # SQL файлы для создания таблиц
└── tests/                   # Интеграционные тесты
```

---

## Git Flow

Ветки:
- **`main`** — Продакшн (сюда руками не пушим)
- **`develop`** — Общая ветка разработки

**Алгоритм работы:**
1.  `git checkout develop` (обновись: `git pull`)
2.  `git checkout -b feature/название-задачи` (например: `feature/add-materials`)
3.  Напиши код, проверь локально
4.  `git push origin feature/название-задачи`
5.  Создай **Pull Request** (PR) в ветку `develop`
6.  Получите **1 аппрув** от коллеги -> Мержим

---

## База данных

**Важно:** Не меняйте структуру БД руками на сервере

* Все изменения — только через файлы миграций в папке `migrations/`
* Локально миграции накатываются при старте контейнера (или через `make migrate`)

---

## Чек-лист перед PR

Перед тем как кидать код на проверку:
1.  Проект запускается в Docker?
2.  Код отформатирован? (`go fmt ./...`)
3.  Если поменял ручки API — обновил Swagger комментарии?
